<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Touch Handler Test - ××‘×—×Ÿ ××’×¢</title>
  <style>
    body {
      font-family: 'Heebo', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .test-section {
      margin-bottom: 30px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .test-card {
      background: #ffffff;
      border: 2px solid #7c3aed;
      border-radius: 16px;
      padding: 20px;
      margin: 10px 0;
      cursor: pointer;
      transition: transform 0.2s;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }
    
    .test-card:active {
      transform: scale(0.98);
    }
    
    .log-area {
      background: #1a1a1a;
      color: #00ff00;
      padding: 15px;
      border-radius: 8px;
      font-family: monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
      margin-top: 15px;
    }
    
    .log-entry {
      margin: 3px 0;
      padding: 3px 0;
      border-bottom: 1px solid #333;
    }
    
    .success {
      color: #00ff00;
    }
    
    .error {
      color: #ff4444;
    }
    
    .info {
      color: #4af;
    }
    
    h2 {
      color: #7c3aed;
      margin-top: 0;
    }
    
    .clear-btn {
      background: #7c3aed;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
    }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 15px;
    }
    
    .stat-box {
      background: #f0f0f0;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #7c3aed;
    }
    
    .stat-label {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="test-section">
    <h2>âœ… ×ª×™×§×•×Ÿ: ×× ×™×¢×ª ×§×œ×™×§×™× ××§×¨×™×™× ×‘×’×œ×™×œ×”</h2>
    <p>× ×¡×” ×œ×’×œ×•×œ ××¢×œ×” ×•××˜×” ×¢×œ ×”×›×¨×˜×™×¡. ×”×•× ×œ× ×××•×¨ ×œ×”×’×™×‘ ××œ× ×× ×›×Ÿ ××ª×” ×œ×•×—×¥ ×‘×××ª.</p>
    
    <div id="test-card" class="test-card">
      <h3>ğŸŠ ×›×¨×˜×™×¡ ××•×¦×¨ ×œ×‘×“×™×§×”</h3>
      <p>× ×¡×” ×œ×’×œ×•×œ ×¢×œ ×”×›×¨×˜×™×¡ ×”×–×” - ×”×•× ×œ× ×××•×¨ ×œ×”×’×™×‘</p>
      <p>× ×¡×” ×œ×œ×—×•×¥ ×§×œ×™×§ ×¨×’×™×œ - ×”×•× ×›×Ÿ ×××•×¨ ×œ×”×’×™×‘</p>
    </div>
    
    <div class="stats">
      <div class="stat-box">
        <div class="stat-value" id="taps">0</div>
        <div class="stat-label">×§×œ×™×§×™× ×ª×§×™× ×™×</div>
      </div>
      <div class="stat-box">
        <div class="stat-value" id="scrolls">0</div>
        <div class="stat-label">×’×œ×™×œ×•×ª ×©× ×× ×¢×•</div>
      </div>
      <div class="stat-box">
        <div class="stat-value" id="accuracy">100%</div>
        <div class="stat-label">×“×™×•×§</div>
      </div>
    </div>
    
    <div class="log-area" id="log"></div>
    <button class="clear-btn" onclick="clearLog()">× ×§×” ×œ×•×’</button>
  </div>

  <script>
    let taps = 0;
    let scrolls = 0;
    let touchStartData = null;
    let touchMoved = false;
    
    const card = document.getElementById('test-card');
    const logArea = document.getElementById('log');
    
    function log(message, type = 'info') {
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      const time = new Date().toLocaleTimeString('he-IL');
      entry.textContent = `[${time}] ${message}`;
      logArea.insertBefore(entry, logArea.firstChild);
      
      // Keep only last 20 entries
      while (logArea.children.length > 20) {
        logArea.removeChild(logArea.lastChild);
      }
    }
    
    function updateStats() {
      document.getElementById('taps').textContent = taps;
      document.getElementById('scrolls').textContent = scrolls;
      const total = taps + scrolls;
      const accuracy = total > 0 ? Math.round((taps / total) * 100) : 100;
      document.getElementById('accuracy').textContent = accuracy + '%';
    }
    
    function clearLog() {
      logArea.innerHTML = '';
      taps = 0;
      scrolls = 0;
      updateStats();
      log('×œ×•×’ × ×•×§×”', 'info');
    }
    
    // Touch Handler Implementation (same as our hook)
    card.addEventListener('touchstart', (e) => {
      const touch = e.touches[0];
      touchStartData = {
        x: touch.clientX,
        y: touch.clientY,
        time: Date.now()
      };
      touchMoved = false;
      log(`touchstart: (${Math.round(touch.clientX)}, ${Math.round(touch.clientY)})`, 'info');
    });
    
    card.addEventListener('touchmove', (e) => {
      touchMoved = true;
      if (touchStartData) {
        const touch = e.touches[0];
        const deltaX = Math.abs(touch.clientX - touchStartData.x);
        const deltaY = Math.abs(touch.clientY - touchStartData.y);
        log(`touchmove: Î”X=${Math.round(deltaX)}px, Î”Y=${Math.round(deltaY)}px`, 'info');
      }
    });
    
    card.addEventListener('touchend', (e) => {
      if (!touchStartData) return;
      
      const touch = e.changedTouches[0];
      const deltaX = Math.abs(touch.clientX - touchStartData.x);
      const deltaY = Math.abs(touch.clientY - touchStartData.y);
      const deltaTime = Date.now() - touchStartData.time;
      
      const threshold = 10;
      const isTap = !touchMoved && 
                    deltaX < threshold && 
                    deltaY < threshold &&
                    deltaTime < 500;
      
      if (isTap) {
        e.preventDefault();
        e.stopPropagation();
        taps++;
        log(`âœ… ×§×œ×™×§ ×–×•×”×”! (Î”X=${Math.round(deltaX)}px, Î”Y=${Math.round(deltaY)}px, ${deltaTime}ms)`, 'success');
        card.style.background = '#e0ffe0';
        setTimeout(() => card.style.background = '#ffffff', 200);
      } else {
        scrolls++;
        log(`ğŸš« ×’×œ×™×œ×” × ×× ×¢×”! (Î”X=${Math.round(deltaX)}px, Î”Y=${Math.round(deltaY)}px, ${deltaTime}ms)`, 'error');
      }
      
      updateStats();
      touchStartData = null;
      touchMoved = false;
    });
    
    // Desktop click support
    card.addEventListener('click', (e) => {
      // Only count if not from touch
      if (e.detail > 0) {
        taps++;
        log('âœ… ×§×œ×™×§ ×¢×›×‘×¨ ×–×•×”×”!', 'success');
        updateStats();
      }
    });
    
    // Initial log
    log('××¢×¨×›×ª ×‘×“×™×§×ª ××’×¢ ××•×›× ×”. ×”×ª×—×œ ×œ×‘×“×•×§!', 'success');
  </script>
</body>
</html>
